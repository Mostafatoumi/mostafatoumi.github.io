<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Active Directory Management - A PowerShell Journey" /><meta property="og:locale" content="en" /><meta name="description" content="Mastering Active Directory: A PowerShell Odyssey" /><meta property="og:description" content="Mastering Active Directory: A PowerShell Odyssey" /><link rel="canonical" href="/posts/ActiveDirectory_Management_with_Powershell/" /><meta property="og:url" content="/posts/ActiveDirectory_Management_with_Powershell/" /><meta property="og:site_name" content="Mostafa Toumi" /><meta property="og:image" content="/assets/img/favicons/HackTheBox/ADDC-LAB/powershell.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-23T13:00:00+01:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="/assets/img/favicons/HackTheBox/ADDC-LAB/powershell.png" /><meta property="twitter:title" content="Active Directory Management - A PowerShell Journey" /><meta name="twitter:site" content="@EmSec0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-11-23T01:07:49+01:00","datePublished":"2022-11-23T13:00:00+01:00","description":"Mastering Active Directory: A PowerShell Odyssey","headline":"Active Directory Management - A PowerShell Journey","image":"/assets/img/favicons/HackTheBox/ADDC-LAB/powershell.png","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/ActiveDirectory_Management_with_Powershell/"},"url":"/posts/ActiveDirectory_Management_with_Powershell/"}</script><title>Active Directory Management - A PowerShell Journey | Mostafa Toumi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mostafa Toumi"><meta name="application-name" content="Mostafa Toumi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/Mostafatoumi/mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/emsec_1.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Mostafa Toumi</a></div><div class="site-subtitle font-italic">Computer Networking Specialist | Penetration Tester | CTF Player</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Mostafatoumi" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/EmSec0" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['Mostafatoumi0','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/962022" aria-label="hackthebox" target="_blank" rel="noopener noreferrer"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/mostafatoumi/" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Active Directory Management - A PowerShell Journey</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Active Directory Management - A PowerShell Journey</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1669204800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 23, 2022 </em> </span> <span> Updated <em class="" data-ts="1700698069" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 23, 2023 </em> </span><div class="mt-3 mb-3"> <a href="/assets/img/favicons/HackTheBox/ADDC-LAB/powershell.png" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/img/favicons/HackTheBox/ADDC-LAB/powershell.png" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/EmSec0">Mostafa Toumi</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1600 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p><strong>Mastering Active Directory: A PowerShell Odyssey</strong></p><h2 id="introduction-to-powershell-and-active-directory"><span class="mr-2">Introduction to PowerShell and Active Directory</span><a href="#introduction-to-powershell-and-active-directory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>PowerShell plays a crucial role in efficiently managing Active Directory, offering powerful cmdlets that streamline various administrative tasks. In this section, we’ll provide a brief overview of PowerShell and highlight its significance in the context of Active Directory.</p><h3 id="brief-overview-of-powershell"><span class="mr-2">Brief Overview of PowerShell</span><a href="#brief-overview-of-powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>PowerShell is a command-line shell and scripting language developed by Microsoft, designed for task automation and configuration management. Its extensibility and integration with various Microsoft products make it a go-to tool for administrators managing Active Directory environments.</p><h3 id="key-cmdlets-for-ad-management"><span class="mr-2">Key Cmdlets for AD Management</span><a href="#key-cmdlets-for-ad-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To harness the power of PowerShell in Active Directory management, it’s essential to familiarize yourself with key cmdlets. These cmdlets serve as building blocks for creating scripts and automating tasks. In the upcoming sections, we’ll delve into the practical usage of these cmdlets, demonstrating how they can simplify user, group, and organizational unit management in Active Directory.</p><h2 id="user-management"><span class="mr-2">User Management</span><a href="#user-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Efficient user management is a key aspect of Active Directory administration, and PowerShell provides powerful cmdlets to streamline these tasks. In this section, we’ll explore how to perform various user management operations using PowerShell.</p><h3 id="creating-new-user-accounts"><span class="mr-2">Creating New User Accounts</span><a href="#creating-new-user-accounts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h3 id="add-new-user-"><span class="mr-2">add new user :</span><a href="#add-new-user-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">New-ADUser</span><span class="w">  </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"emsec.sec"</span><span class="w"> </span><span class="nt">-GivenName</span><span class="w"> </span><span class="s2">"emsec"</span><span class="w"> </span><span class="nt">-Surname</span><span class="w"> </span><span class="s2">"sec"</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s2">"CN=users,DC=dc,DC=lab,DC=local"</span><span class="w"> </span><span class="nt">-Enabled</span><span class="w"> </span><span class="bp">$true</span><span class="w"> </span><span class="nt">-AccountPassword</span><span class="w"> </span><span class="p">(</span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="s2">"Password@123!"</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-Force</span><span class="p">)</span><span class="w"> </span><span class="nt">-ChangePasswordAtLogon</span><span class="w"> </span><span class="bp">$false</span><span class="w">
</span></pre></table></code></div></div><h3 id="modifying-user-attributes-and-properties"><span class="mr-2">Modifying User Attributes and Properties</span><a href="#modifying-user-attributes-and-properties" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">Set-ADUser</code> cmdlet allows you to modify user attributes and properties.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Set-ADUser</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">emsec.sec</span><span class="w"> </span><span class="nt">-Description</span><span class="w"> </span><span class="s2">"Updated description"</span><span class="w"> </span><span class="nt">-Title</span><span class="w"> </span><span class="s2">"Manager"</span><span class="w">
</span></pre></table></code></div></div><h3 id="disabling-and-enabling-user-accounts"><span class="mr-2">Disabling and enabling user accounts.</span><a href="#disabling-and-enabling-user-accounts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To disable or enable user accounts, use the <code class="language-plaintext highlighter-rouge">Disable-ADAccount</code> and <code class="language-plaintext highlighter-rouge">Enable-ADAccount</code> cmdlets, respectively:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># Disable a user account</span><span class="w">
</span><span class="n">Disable-ADAccount</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">emsec.sec</span><span class="w">

</span><span class="c"># Enable a user account</span><span class="w">
</span><span class="n">Enable-ADAccount</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">emsec.sec</span><span class="w">

</span></pre></table></code></div></div><h3 id="resetting-user-passwords-with-powershell"><span class="mr-2">Resetting user passwords with PowerShell.</span><a href="#resetting-user-passwords-with-powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Resetting user passwords is a common task. Use the <code class="language-plaintext highlighter-rouge">Set-ADAccountPassword</code> cmdlet to set a new password for a user:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Reset user password</span><span class="w">
</span><span class="n">Set-ADAccountPassword</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">emsec.sec</span><span class="w"> </span><span class="nt">-Reset</span><span class="w"> </span><span class="nt">-NewPassword</span><span class="w"> </span><span class="p">(</span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="s2">"New_Password@123!"</span><span class="w"> </span><span class="nt">-Force</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><h2 id="group-management-"><span class="mr-2">Group Management :</span><a href="#group-management-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Effective group management is essential for organizing and controlling access in Active Directory. PowerShell simplifies these tasks through various cmdlets. Let’s explore how to perform key group management operations.</p><h4 id="creating-security-groups-and-distribution-groups"><span class="mr-2">Creating Security Groups and Distribution Groups</span><a href="#creating-security-groups-and-distribution-groups" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Use the <code class="language-plaintext highlighter-rouge">New-ADGroup</code> cmdlet to create security groups or distribution groups. Customize the command based on your requirements:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Create a security group</span><span class="w">
</span><span class="n">New-ADGroup</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"pentesters"</span><span class="w"> </span><span class="nt">-GroupScope</span><span class="w"> </span><span class="nx">Security</span><span class="w"> </span><span class="nt">-GroupScope</span><span class="w"> </span><span class="nx">Global</span><span class="w">

</span><span class="c"># Create a distribution group</span><span class="w">
</span><span class="n">New-ADGroup</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"pentesters"</span><span class="w"> </span><span class="nt">-GroupScope</span><span class="w"> </span><span class="nx">Distribution</span><span class="w"> </span><span class="nt">-GroupScope</span><span class="w"> </span><span class="nx">Global</span><span class="w">
</span></pre></table></code></div></div><h4 id="adding-and-removing-users-from-groups"><span class="mr-2">Adding and removing users from groups.</span><a href="#adding-and-removing-users-from-groups" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Manage group memberships with the <code class="language-plaintext highlighter-rouge">Add-ADGroupMember</code> and <code class="language-plaintext highlighter-rouge">Remove-ADGroupMember</code> cmdlets:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># Add a user to a group</span><span class="w">
</span><span class="n">Add-ADGroupMember</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">pentesters</span><span class="w"> </span><span class="nt">-Members</span><span class="w"> </span><span class="nx">emsec.sec</span><span class="w"> 

</span><span class="c"># Remove a user from a group</span><span class="w">
</span><span class="n">Remove-ADGroupMember</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">pentesters</span><span class="w"> </span><span class="nt">-Members</span><span class="w"> </span><span class="nx">emsec.sec</span><span class="w">

</span></pre></table></code></div></div><h3 id="managing-group-memberships"><span class="mr-2">Managing group memberships.</span><a href="#managing-group-memberships" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">Get-ADGroupMember</code> cmdlet allows you to retrieve members of a group:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Get members of a group</span><span class="w">
</span><span class="n">Get-ADGroupMember</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="nx">pentesters</span><span class="w">
</span></pre></table></code></div></div><h2 id="organizational-unit-ou-management"><span class="mr-2">Organizational Unit (OU) Management</span><a href="#organizational-unit-ou-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Organizational Units (OUs) provide a way to organize and manage objects within Active Directory. PowerShell offers convenient cmdlets for creating, managing, and moving objects between OUs. Let’s explore how to perform key OU management tasks.</p><h3 id="creating-and-managing-organizational-units-with-powershell"><span class="mr-2">Creating and managing Organizational Units with PowerShell.</span><a href="#creating-and-managing-organizational-units-with-powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To create and manage OUs, you can use the <code class="language-plaintext highlighter-rouge">New-ADOrganizationalUnit</code> and <code class="language-plaintext highlighter-rouge">Get-ADOrganizationalUnit</code> cmdlets. Here’s an example of creating a new OU:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Create a new Organizational Unit</span><span class="w">
</span><span class="n">New-ADOrganizationalUnit</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">pentesters_ou</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s2">"DC=dc,DC=lab,DC=local"</span><span class="w">
</span></pre></table></code></div></div><p>You can retrieve information about existing OUs using:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Get information about OUs</span><span class="w">
</span><span class="n">Get-ADOrganizationalUnit</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></pre></table></code></div></div><h3 id="moving-objects-between-ous"><span class="mr-2">Moving objects between OUs.</span><a href="#moving-objects-between-ous" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Moving objects between OUs is a common administrative task. The <code class="language-plaintext highlighter-rouge">Move-ADObject</code> cmdlet allows you to accomplish this:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Move a user to a different OU</span><span class="w">
</span><span class="n">Move-ADObject</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"CN=emsec.sec,OU=users,DC=lab,DC=local"</span><span class="w"> </span><span class="nt">-TargetPath</span><span class="w"> </span><span class="s2">"OU=pentesters_ou,DC=lab,DC=local"</span><span class="w">
</span></pre></table></code></div></div><p>This command moves the specified object (in this case, a user) from one OU to another.</p><p><strong>Note: You can move any object, such as groups or users, as needed</strong></p><h2 id="automation-and-scripting"><span class="mr-2">Automation and Scripting</span><a href="#automation-and-scripting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Automation is a key advantage of PowerShell, allowing administrators to streamline and simplify routine Active Directory management tasks. In this section, we’ll explore the fundamentals of writing scripts, using variables and loops, and implementing error handling in PowerShell.</p><h4 id="writing-scripts-to-automate-common-ad-management-tasks"><span class="mr-2">Writing scripts to automate common AD management tasks.</span><a href="#writing-scripts-to-automate-common-ad-management-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Scripts provide a powerful mechanism for automating repetitive tasks. You can use PowerShell scripts to perform various Active Directory operations, such as creating users, modifying attributes, and managing groups. Here’s a simple example script:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script for user creation</span><span class="w">
</span><span class="nv">$users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@(</span><span class="s2">"User1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"User2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"User3"</span><span class="p">)</span><span class="w">

</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$user</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">New-ADUser</span><span class="w"> </span><span class="nt">-SamAccountName</span><span class="w"> </span><span class="nv">$user</span><span class="w"> </span><span class="nt">-UserPrincipalName</span><span class="w"> </span><span class="s2">"</span><span class="nv">$user</span><span class="s2">@domain.com"</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nv">$user</span><span class="w"> </span><span class="nt">-Enabled</span><span class="w"> </span><span class="bp">$true</span><span class="w"> </span><span class="nt">-AccountPassword</span><span class="w"> </span><span class="p">(</span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="s2">"Password@123!"</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-Force</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><h4 id="using-variables-and-loops-in-powershell-scripts"><span class="mr-2">Using variables and loops in PowerShell scripts.</span><a href="#using-variables-and-loops-in-powershell-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Variables and loops are essential components of scripting. Variables store data, and <code class="language-plaintext highlighter-rouge">loops</code> allow you to repeat a block of code. Here’s an example demonstrating their usage:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script with variables and loops</span><span class="w">
</span><span class="nv">$domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"domain.com"</span><span class="w">
</span><span class="nv">$users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@(</span><span class="s2">"User1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"User2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"User3"</span><span class="p">)</span><span class="w">

</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$user</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$userPrincipalName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="nv">$user</span><span class="s2">@</span><span class="nv">$domain</span><span class="s2">"</span><span class="w">
    </span><span class="n">New-ADUser</span><span class="w"> </span><span class="nt">-SamAccountName</span><span class="w"> </span><span class="nv">$user</span><span class="w"> </span><span class="nt">-UserPrincipalName</span><span class="w"> </span><span class="nv">$userPrincipalName</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nv">$user</span><span class="w"> </span><span class="nt">-Enabled</span><span class="w"> </span><span class="bp">$true</span><span class="w"> </span><span class="nt">-AccountPassword</span><span class="w"> </span><span class="p">(</span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="s2">"Password@123!"</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-Force</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></table></code></div></div><h4 id="error-handling-in-powershell-scripts"><span class="mr-2">Error handling in PowerShell scripts.</span><a href="#error-handling-in-powershell-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Error handling ensures that scripts respond appropriately to unexpected situations. The <code class="language-plaintext highlighter-rouge">try</code> and <code class="language-plaintext highlighter-rouge">catch</code> blocks in PowerShell facilitate effective error handling. Consider the following example:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script with error handling</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="c"># Command that might throw an error</span><span class="w">
    </span><span class="n">Get-ADUser</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"NonExistentUser"</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">Stop</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="c"># Handle the error</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"User not found. Error details: </span><span class="bp">$_</span><span class="s2">"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></table></code></div></div><h2 id="security-best-practices"><span class="mr-2">Security Best Practices</span><a href="#security-best-practices" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Maintaining a secure Active Directory environment is paramount for any organization. PowerShell provides powerful tools to implement security best practices, such as role-based access control (RBAC) and auditing. Let’s delve into these essential aspects.</p><h4 id="implementing-role-based-access-control-in-ad-with-powershell"><span class="mr-2">Implementing role-based access control in AD with PowerShell.</span><a href="#implementing-role-based-access-control-in-ad-with-powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>RBAC allows administrators to assign specific roles and permissions to users or groups, ensuring that they have the necessary access without granting unnecessary privileges. PowerShell facilitates RBAC implementation through the <code class="language-plaintext highlighter-rouge">Add-ADPermission</code> and <code class="language-plaintext highlighter-rouge">Remove-ADPermission</code> cmdlets. Here’s a simplified example:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script for RBAC</span><span class="w">
</span><span class="c"># Granting permission</span><span class="w">
</span><span class="n">Add-ADPermission</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"OU=pentesters_ou,DC=dc,DC=lab,DC=local"</span><span class="w"> </span><span class="nt">-User</span><span class="w"> </span><span class="s2">"emsec.sec"</span><span class="w"> </span><span class="nt">-AccessRights</span><span class="w"> </span><span class="s2">"ReadProperty"</span><span class="p">,</span><span class="w"> </span><span class="s2">"WriteProperty"</span><span class="w"> </span><span class="nt">-Properties</span><span class="w"> </span><span class="s2">"Description"</span><span class="w">

</span><span class="c"># Revoking permission</span><span class="w">
</span><span class="n">Remove-ADPermission</span><span class="w"> </span><span class="nt">-Identity</span><span class="w">  </span><span class="s2">"OU=pentesters_ou,DC=dc,DC=lab,DC=local"</span><span class="w"> </span><span class="nt">-User</span><span class="w"> </span><span class="s2">"emsec.sec"</span><span class="w"> </span><span class="nt">-AccessRights</span><span class="w"> </span><span class="s2">"ReadProperty"</span><span class="p">,</span><span class="w"> </span><span class="s2">"WriteProperty"</span><span class="w"> </span><span class="nt">-Properties</span><span class="w"> </span><span class="s2">"Description"</span><span class="w">
</span></pre></table></code></div></div><h4 id="auditing-and-monitoring-ad-changes-using-powershell"><span class="mr-2">Auditing and monitoring AD changes using PowerShell.</span><a href="#auditing-and-monitoring-ad-changes-using-powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Monitoring changes in Active Directory is critical for security and compliance. PowerShell provides the Get-ADObject cmdlet for querying changes. Here’s an example to retrieve recent changes:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script for AD auditing</span><span class="w">
</span><span class="c"># Retrieve recent changes in Active Directory</span><span class="w">
</span><span class="nv">$startDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Get-Date</span><span class="p">)</span><span class="o">.</span><span class="nf">AddDays</span><span class="p">(</span><span class="nt">-7</span><span class="p">)</span><span class="w">
</span><span class="nx">Get-ADObject</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="p">{</span><span class="n">WhenChanged</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="nv">$startDate</span><span class="p">}</span><span class="w"> </span><span class="nt">-Properties</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-Table</span><span class="w"> </span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">WhenChanged</span><span class="w">

</span></pre></table></code></div></div><p>Regularly <code class="language-plaintext highlighter-rouge">auditing</code> and <code class="language-plaintext highlighter-rouge">monitoring changes</code> help identify and respond to security incidents promptly, enhancing the overall security posture of your Active Directory environment.</p><h2 id="advanced-topics"><span class="mr-2">Advanced Topics</span><a href="#advanced-topics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Exploring advanced topics in Active Directory enhances your administrative capabilities. PowerShell offers powerful cmdlets to manage trusts, query specific information, and work with fine-grained password policies. Let’s delve into these advanced areas.</p><h4 id="managing-active-directory-trusts"><span class="mr-2">Managing Active Directory trusts.</span><a href="#managing-active-directory-trusts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Active Directory trusts are crucial for establishing secure communication between domains. PowerShell provides the <code class="language-plaintext highlighter-rouge">Get-ADTrust</code> and <code class="language-plaintext highlighter-rouge">Set-ADTrust</code> cmdlets to manage trusts efficiently:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script for managing trusts</span><span class="w">
</span><span class="c"># Get information about trusts</span><span class="w">
</span><span class="n">Get-ADTrust</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*</span><span class="w">

</span><span class="c"># Modify trust properties</span><span class="w">
</span><span class="n">Set-ADTrust</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"TrustName"</span><span class="w"> </span><span class="nt">-NewTrustDirection</span><span class="w"> </span><span class="nx">Bidirectional</span><span class="w">
</span></pre></table></code></div></div><p>These cmdlets enable administrators to retrieve information about existing trusts and modify trust properties as needed.</p><h4 id="querying-ad-for-specific-information"><span class="mr-2">Querying AD for specific information.</span><a href="#querying-ad-for-specific-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Efficient querying of Active Directory is essential for retrieving specific information. The <code class="language-plaintext highlighter-rouge">Get-ADObject</code> cmdlet is versatile for this purpose. Here’s an example to query user information:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell script for querying AD</span><span class="w">
</span><span class="c"># Get information about users</span><span class="w">
</span><span class="n">Get-ADObject</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="p">{</span><span class="n">ObjectClass</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s2">"user"</span><span class="p">}</span><span class="w"> </span><span class="nt">-Properties</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="nx">SamAccountName</span><span class="p">,</span><span class="w"> </span><span class="nx">Enabled</span><span class="w">
</span></pre></table></code></div></div><p>Customize the script to query the information you need based on the object class and properties.</p><h4 id="working-with-fine-grained-password-policies"><span class="mr-2">Working with fine-grained password policies.</span><a href="#working-with-fine-grained-password-policies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Fine-grained password policies allow organizations to define password policies for different sets of users. PowerShell facilitates management through the <code class="language-plaintext highlighter-rouge">Get-ADFineGrainedPasswordPolicy</code> and <code class="language-plaintext highlighter-rouge">Set-ADFineGrainedPasswordPolicy</code> cmdlets:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># Example PowerShell for managing fine-grained password policies</span><span class="w">
</span><span class="c"># Get information about fine-grained password policies</span><span class="w">
</span><span class="n">Get-ADFineGrainedPasswordPolicy</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="o">*</span><span class="w">

</span><span class="c"># Modify password policy properties</span><span class="w">
</span><span class="n">Set-ADFineGrainedPasswordPolicy</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"PolicyName"</span><span class="w"> </span><span class="nt">-MaxPasswordAge</span><span class="w"> </span><span class="s2">"30.00:00:00"</span><span class="w">

</span></pre></table></code></div></div><p>These cmdlets enable administrators to retrieve information about existing fine-grained password policies and modify policy properties to meet security requirements.</p><p>Exploring these advanced topics equips administrators with the tools needed to manage complex aspects of Active Directory effectively.</p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In conclusion, mastering Active Directory management with PowerShell opens up a world of efficiency and automation for administrators. Let’s recap the key points covered in this guide:</p><ul><li><p><strong>User and Group Management:</strong> The guide provided insights into creating and managing user accounts, modifying attributes, and efficiently managing group memberships.</p><li><p><strong>Organizational Unit (OU) Management:</strong> You learned how to create and manage OUs, as well as move objects between OUs using PowerShell.</p><li><p><strong>Automation and Scripting:</strong> Understanding the basics of scripting, using variables and loops, and implementing error handling in PowerShell scripts for efficient AD automation.</p><li><p><strong>Security Best Practices:</strong> We covered implementing role-based access control (RBAC) and auditing AD changes, ensuring a secure Active Directory environment.</p><li><p><strong>Advanced Topics:</strong> Explored managing AD trusts, querying AD for specific information, and working with fine-grained password policies.</p></ul><h3 id="encouragement-to-explore"><span class="mr-2">Encouragement to Explore</span><a href="#encouragement-to-explore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As you continue your journey in Active Directory management, we encourage you to explore additional PowerShell cmdlets and functionalities. The PowerShell ecosystem is vast, and continual exploration will deepen your expertise and make your administrative tasks even more efficient.</p><p>Whether you’re a seasoned administrator or just starting, the combination of PowerShell and Active Directory offers endless possibilities for automation and optimization. Happy scripting!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/powershell/'>Powershell</a>, <a href='/categories/ad-dc/'>AD DC</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >Active Directory</a> <a href="/tags/powershell/" class="post-tag no-text-decoration" >powershell</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Active%20Directory%20Management%20-%20A%20PowerShell%20Journey%20-%20Mostafa%20Toumi&url=%2Fposts%2FActiveDirectory_Management_with_Powershell%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Active%20Directory%20Management%20-%20A%20PowerShell%20Journey%20-%20Mostafa%20Toumi&u=%2Fposts%2FActiveDirectory_Management_with_Powershell%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FActiveDirectory_Management_with_Powershell%2F&text=Active%20Directory%20Management%20-%20A%20PowerShell%20Journey%20-%20Mostafa%20Toumi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fposts%2FActiveDirectory_Management_with_Powershell%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=Active%20Directory%20Management%20-%20A%20PowerShell%20Journey%20-%20Mostafa%20Toumi&url=%2Fposts%2FActiveDirectory_Management_with_Powershell%2F" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/LDAP/">LDAP Lightweight Directory Access Protocol</a><li><a href="/posts/HackTheBox-Sau/">HackTheBox-Sau Walkthrough</a><li><a href="/posts/DNS/">DNS Domain Name System</a><li><a href="/posts/ActiveDirectory_Management_with_Powershell/">Active Directory Management - A PowerShell Journey</a><li><a href="/posts/ADDC-LAB-PART_01/">Active Directory Mastery - A Guide to Windows Server Setup for Penetration Testing</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/kerberos/">Kerberos</a> <a class="post-tag" href="/tags/ldap3/">ldap3</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ntlm/">NTLM</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/python3/">python3</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/DNS/"><div class="card-body"> <em class="small" data-ts="1669183200" data-df="ll" > Nov 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DNS Domain Name System</h3><div class="text-muted small"><p> DNS : Introduction: DNS (Domain Name System) is a fundamental protocol used on the internet and local networks to translate human-readable domain names into numerical IP addresses. It plays a cruc...</p></div></div></a></div><div class="card"> <a href="/posts/LDAP/"><div class="card-body"> <em class="small" data-ts="1669183200" data-df="ll" > Nov 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LDAP Lightweight Directory Access Protocol</h3><div class="text-muted small"><p> LDAP Introduction to LDAP : LDAP Lightweight Directory Access Protocol is a widely used protocol for accessing and managing directory information. When integrated with Active Directory (AD), LDAP...</p></div></div></a></div><div class="card"> <a href="/posts/KERBEROS/"><div class="card-body"> <em class="small" data-ts="1669186800" data-df="ll" > Nov 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kerberos Active DIrectory</h3><div class="text-muted small"><p> Kerberos Introduction: What is Kerberos protocol : Kerberos is a network authentication protocol designed to provide secure authentication for users and services in a distributed computing envi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/NTLM/" class="btn btn-outline-primary" prompt="Older"><p>NTLM Authentication in Active Directory</p></a> <a href="/posts/HackTheBox-Sekhmet_/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox-Sekhmet Walkthrough</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/kerberos/">Kerberos</a> <a class="post-tag" href="/tags/ldap3/">ldap3</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ntlm/">NTLM</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/python3/">python3</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/EmSec0">Mostafa Toumi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
